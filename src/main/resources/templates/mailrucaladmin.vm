## Created by Andrey Markelov 29-08-2012.
## Copyright Mail.Ru Group 2012. All rights reserved.
<html>
  <head>
    <title>$i18n.getText("mailrucal.settingstitle")</title>
    <meta name="decorator" content="admin"/>
    $webResourceManager.requireResource("jira.webresources:global-static")
    $webResourceManager.requireResource("jira.webresources:jira-global")
    $webResourceManager.requireResource("com.atlassian.auiplugin:ajs")
    $webResourceManager.requireResource("jira.webresources:autocomplete")
    $webResourceManager.requireResource("ru.mail.jira.plugins.mailrucal:jcalendar-admin")
  </head>
  <body class="aui">
  #if($action.hasAdminPermission())
    <fieldset rel="pgadmin" class="hidden user-picker-params">
      <input type="hidden" title="formName" value="jiraform">
      <input type="hidden" title="fieldName" value="pgadmin">
      <input type="hidden" title="fieldId" value="pgadmin">
      <input type="hidden" title="multiSelect" value="false">
      <input type="hidden" title="userPickerEnabled" value="true">
    </fieldset>
    #if ($action.hasAnyErrors())
    <div class="aui-message error">
      <h4>$action.getText("mailrucal.admin.configuration.error")</h4>
      <ul>
      #foreach ($error in $action.getErrorMessages())
        <li>$action.getText($error)</li>
      #end
      #foreach ($error in $action.errors)
        <li>$error</li>
      #end
      </ul>
    </div>
    #end
    #if ($saved)
    <div class="aui-message closeable shadowed">
      <p class="title"><span class="aui-icon icon-success"></span><strong>$action.getText("mailrucal.admin.configuration.success.text")</strong></p>
    </div>
    #end
    <form onsubmit="if (this.submitted) return false; this.submitted = true; return true" name="jiraform" method="post" action="ViewMailRuCalendarAdmin.jspa">
      <table class="dlgtable">
        <tr>
          <td class="dlgtablekey"><label for="calname">$i18n.getText("mailrucal.calname")*</label></td>
          <td valign="top">
            <table class="justtable">
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <input type="text" size="30" id="calname" name="calname"/>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="dlgtablekey"><label for="caldescr">$i18n.getText("mailrucal.caldescr")</label></td>
          <td valign="top">
            <table class="justtable">
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <textarea rows="3" cols="30" id="caldescr" name="caldescr"></textarea>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="dlgtablekey"><label for="calcolor">$i18n.getText("mailrucal.calcolor")*</label></td>
          <td valign="top">
            <table class="justtable">
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <select id="calcolor" name="calcolor" style="background-color: #efe381; color: white;" onchange="changeColor();" onkeydown="changeColor();" onkeyup="changeColor();">
                          <option style="background-color: #efe381;" value="#efe381">Yellow</option>
                          <option style="background-color: #008B8B;" value="#008B8B">Dark Cyan</option>
                          <option style="background-color: #f4a36d;" value="#f4a36d">Orange</option>
                          <option style="background-color: #696969;" value="#696969">Dim Gray</option>
                          <option style="background-color: #FFD700;" value="#FFD700">Gold</option>
                          <option style="background-color: #FF0000;" value="#FF0000">Red</option>
                          <option style="background-color: #0000FF;" value="#0000FF">Blue</option>
                          <option style="background-color: #FFC0CB;" value="#FFC0CB">Pink</option>
                        </select>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="dlgtablekey"><label>$i18n.getText("mailrucal.caldisplay")*</label></td>
          <td valign="top">
            <table class="justtable">
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <div>
                          <input onclick="fillProj();" type="radio" id="display" name="display" value="project" checked="checked"/><span>$i18n.getText("mailrucal.calproj")</span>&nbsp;&nbsp;
                          <input onclick="fillJcl();" type="radio" id="display" name="display" value="jcl"/><span>$i18n.getText("mailrucal.calfilter")</span>
                        </div>
                        <select id="mainsel" name="mainsel" style="background-color: white;">
                        #foreach($entry in $action.getProjects())
                          <option value="$entry.getId()">$entry.getName()</option>
                        #end
                        </select>
                        <select id="projsel" name="projsel" style="display: none;">
                        #foreach($entry in $action.getProjects())
                          <option value="$entry.getId()">$entry.getName()</option>
                        #end
                        </select>
                        <select id="jclsel" name="jclsel" style="display: none;">
                        #foreach($entry in $action.getFilters())
                          <option value="$entry.getId()">$entry.getName()</option>
                        #end
                        </select>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="dlgtablekey"><label>$i18n.getText("mailrucal.calshow")*</label></td>
          <td valign="top">
            <table class="justtable">
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <input onclick="setIssueDueDate();" type="radio" id="showfld" name="showfld" value="idd" checked="checked"/><span>$i18n.getText("mailrucal.calidd")</span>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <input onclick="setCustomDate();" type="radio" id="showfld" name="showfld" value="cdp"/><span>$i18n.getText("mailrucal.customdatepoint")</span>
                      </td>
                    </tr>
                    <tr>
                      <td valign="top">
                        <input type="text" size="15" id="cdpinput" name="cdpinput" disabled="disabled"/>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr>
                <td valign="top">
                  <table class="justtable">
                    <tr>
                      <td valign="top">
                        <input onclick="setRange();" type="radio" id="showfld" name="showfld" value="cdr"/><span>$i18n.getText("mailrucal.daterange")</span>
                      </td>
                    </tr>
                    <tr>
                      <td valign="top">
                        <input type="text" size="13" id="startpoint" name="startpoint" disabled="disabled"/> - <input type="text" size="13" id="endpoint" name="endpoint" disabled="disabled"/>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
        <td class="dlgtablekey"><label>$i18n.getText("mailrucal.share")</label></td>
        <td valign="top">
            <table class="justtable">
                <tr>
                    <td valign="top">
                        <table class="justtable">
                            <tr>
                                <td valign="top">
                                    <div id="share_display_div"></div>
                                    <div id="share_div">
                                      <div id="share_display_component">
                                        <div>
                                          <div>
                                            <input id="sharesel" name="sharesel" onclick="setShareGroup();" type="radio" checked="checked"/><span>$i18n.getText("mailrucal.sharegroup")</span>&nbsp;&nbsp;
                                            <input id="sharesel" name="sharesel" onclick="setShareProject();" type="radio" /><span>$i18n.getText("mailrucal.shareproject")</span>
                                          </div>
                                          <span id="share_group">
                                            <select id="groupShare" style="background-color: white;">
                                              #foreach($group in $allGroups)
                                              <option value="$group.getName()">$group.getName()</option>
                                              #end
                                            </select>
                                            <span onclick="addGroup();" class="addShare" id="share_add_group"><img src="/jira/images/icons/16add_blue.png"/>Add</span>
                                          </span>
                                          <span id="share_project" style="display:none">
                                            <select id="projectShare-project" style="background-color: white;">
                                            #foreach($entry in $action.getProjects())
                                              <option roles="$action.getProjectRoles().keySet().toString()" value="$entry.getId()">$entry.getName()</option>
                                            #end
                                            </select>
                                            <img src="/jira/images/icons/hierarchy_arrow.gif" alt="Arrow" width="10px" height="10px"/>
                                            <select id="projectShare-role" style="background-color: white;">
                                              <option value="">All</option>
                                              <optgroup label="Project Roles" id="projectShare-role-group">
                                                #foreach($entry in $action.getProjectRoles().entrySet())
                                                <option value="$entry.key">$entry.value</option>
                                                #end
                                              </optgroup>
                                            </select>
                                            <span onclick="addProject();" class="addShare" id="share_add_project"><img src="/jira/images/icons/16add_blue.png"/>Add</span>
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
        <tr>
          <td class="dlgtablekey">
            <input class="button submit" type="submit" name="add" value="$action.getText("common.words.save")" accesskey="S" title="Press Alt+Shift+S to submit form"/>
          </td>
          <td>
          </td>
        </tr>
      </table>
      <input id="shares_data" name="shares_data" style="display:none;" value="[]"/>
      <img onclick="removeGroup(event);" id="share_trash" height="16px" width="16px" style="display: none" class="shareTrash" src="/jira/images/icons/trash_16.gif" title="Delete Share" alt="Delete Share"/> <input id="share_type_hidden" name="shareValues" type="hidden"/>
    </form>
  #else
    <div class="errorArea">$action.getText("mailrucal.admin.access")</div>
  #end
  </body>
</html>
